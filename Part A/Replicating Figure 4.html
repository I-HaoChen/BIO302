<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Part A exam: Reproducing Figure 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Replicating Figure 4_files/libs/clipboard/clipboard.min.js"></script>
<script src="Replicating Figure 4_files/libs/quarto-html/quarto.js"></script>
<script src="Replicating Figure 4_files/libs/quarto-html/popper.min.js"></script>
<script src="Replicating Figure 4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Replicating Figure 4_files/libs/quarto-html/anchor.min.js"></script>
<link href="Replicating Figure 4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Replicating Figure 4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Replicating Figure 4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Replicating Figure 4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Replicating Figure 4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Part A exam: Reproducing Figure 4</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="original-paper-doi" class="level2">
<h2 class="anchored" data-anchor-id="original-paper-doi">Original Paper DOI</h2>
<p><a href="https://doi.org/10.1371/journal.pone.0122380" class="uri">https://doi.org/10.1371/journal.pone.0122380</a></p>
<p>Article Source:<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0122380" title="Back to original article"><strong>Reconstructing the Migratory Behavior and Long-Term Survivorship of Juvenile Chinook Salmon under Contrasting Hydrologic Regimes</strong></a></p>
<p>Sturrock&nbsp;AM, Wikert&nbsp;JD, Heyne&nbsp;T, Mesick&nbsp;C, Hubbard&nbsp;AE, et al.&nbsp;(2015) Reconstructing the Migratory Behavior and Long-Term Survivorship of Juvenile Chinook Salmon under Contrasting Hydrologic Regimes. PLOS ONE 10(5): e0122380. <a href="https://doi.org/10.1371/journal.pone.0122380" class="uri">https://doi.org/10.1371/journal.pone.0122380</a></p>
</section>
<section id="data-citation" class="level2">
<h2 class="anchored" data-anchor-id="data-citation">Data Citation</h2>
<p>Sturrock, Anna M. et al.&nbsp;(2016), Data from: Reconstructing the migratory behavior and long-term survivorship of juvenile Chinook salmon under contrasting hydrologic regimes, Dryad, Dataset, <a href="https://doi.org/10.5061/dryad.c56rk" class="uri">https://doi.org/10.5061/dryad.c56rk</a></p>
</section>
<section id="replicating-figure-4" class="level2">
<h2 class="anchored" data-anchor-id="replicating-figure-4">Replicating Figure 4</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(checker)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>checker<span class="sc">::</span><span class="fu">chk_requirements</span>(<span class="st">"https://raw.githubusercontent.com/richardjtelford/Bio302/main/checker/bio302.yaml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>→ Date = 2023-06-27 15:31:21</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>→ os = Windows 10 x64 (build 19045)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✖ Are you using RStudio?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ R version 4.2.2 is installed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ quarto version 1.3.353 is installed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ git version 2.33.0..2 is installed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>→ Checking R packages</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ tidyverse version 2.0.0 is installed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ usethis version 2.2.0 is installed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ quarto version 1.2 is installed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ lme4 version 1.1.33 is installed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✖ You have some issues that need addressing</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at C:/Users/chen/OneDrive - NORCE/BIO302/BIO302</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fdrtool)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'

The following object is masked from 'package:purrr':

    discard

The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
</div>
<p>You can add options to executable code like this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">=</span><span class="fu">here</span>(<span class="st">"Part A"</span>, <span class="st">"Daily_N_fry_parr smolt_2000 2003_DRYAD.xlsx"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>path</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/chen/OneDrive - NORCE/BIO302/BIO302/Part A/Daily_N_fry_parr smolt_2000 2003_DRYAD.xlsx"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>daily_counts <span class="ot">=</span> <span class="fu">read_excel</span>(path)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(daily_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
   Year   Day `Flow (CFS)` `Temperature (oF)` `Turbidity (NTU)` `N fry` `N parr`
  &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;              &lt;dbl&gt;             &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1  2000     1          360               47.5             1.4     0            0
2  2000     2          359               47.8             0.997   0.599        0
3  2000     3          358               48.0             0.9     0            0
4  2000     4          360               47.5             1       0            0
5  2000     5          362               47.5             0.9     0            0
6  2000     6          354               47.5             0.75    0            0
# ℹ 1 more variable: `N smolt` &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add date column</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>daily_counts <span class="ot">=</span> daily_counts <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For whatever reason indexing starts at 0, meaning Day 0 is the 01.01 of a year. Therefore -1 for the dates</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">date =</span>  <span class="fu">as.Date</span>(Day <span class="sc">-</span> <span class="dv">1</span>, <span class="at">origin =</span> <span class="fu">sprintf</span>(<span class="st">"%s-01-01"</span>, Year)),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">`</span><span class="at">N_fry</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">N fry</span><span class="st">`</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>     <span class="st">`</span><span class="at">N_parr</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">N parr</span><span class="st">`</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>     <span class="st">`</span><span class="at">N_smolt</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">N smolt</span><span class="st">`</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>     <span class="co"># Converting units to metric ones</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">Flow =</span> <span class="st">`</span><span class="at">Flow (CFS)</span><span class="st">`</span> <span class="sc">/</span><span class="fl">35.313378</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">temperature =</span> (<span class="st">`</span><span class="at">Temperature (oF)</span><span class="st">`</span> <span class="sc">-</span> <span class="dv">32</span>) <span class="sc">*</span><span class="dv">5</span><span class="sc">/</span><span class="dv">9</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>daily_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 362 × 14
    Year   Day `Flow (CFS)` `Temperature (oF)` `Turbidity (NTU)` `N fry`
   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;              &lt;dbl&gt;             &lt;dbl&gt;   &lt;dbl&gt;
 1  2000     1          360               47.5             1.4     0    
 2  2000     2          359               47.8             0.997   0.599
 3  2000     3          358               48.0             0.9     0    
 4  2000     4          360               47.5             1       0    
 5  2000     5          362               47.5             0.9     0    
 6  2000     6          354               47.5             0.75    0    
 7  2000     7          352               48.0             0.65   10.8  
 8  2000     8          355               47.8             0.5    11.3  
 9  2000     9          354               47.2             1.3    11.6  
10  2000    10          352               48.0             1.3     0    
# ℹ 352 more rows
# ℹ 8 more variables: `N parr` &lt;dbl&gt;, `N smolt` &lt;dbl&gt;, date &lt;date&gt;,
#   N_fry &lt;dbl&gt;, N_parr &lt;dbl&gt;, N_smolt &lt;dbl&gt;, Flow &lt;dbl&gt;, temperature &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Super dumb method to rescale the second axis in the plots via calculating the scale towards 100.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>scale_factor_2000 <span class="ot">=</span> <span class="fu">max</span>(daily_counts[daily_counts<span class="sc">$</span>Year <span class="sc">==</span> <span class="st">"2000"</span>,]<span class="sc">$</span>temperature,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">95</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plot_2000 <span class="ot">=</span> <span class="fu">ggplot</span>(daily_counts[daily_counts<span class="sc">$</span>Year <span class="sc">==</span> <span class="st">"2000"</span>,], <span class="fu">aes</span>(<span class="at">x=</span>date)) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># All the graphs for the primary axis, NO LEGEND!</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> N_fry<span class="sc">/</span><span class="dv">1000</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">yaxis =</span> <span class="st">"y1"</span>) <span class="sc">+</span>  </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> N_parr<span class="sc">/</span><span class="dv">1000</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">yaxis =</span> <span class="st">"y1"</span>) <span class="sc">+</span>  </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> N_smolt<span class="sc">/</span><span class="dv">1000</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">yaxis =</span> <span class="st">"y1"</span>) <span class="sc">+</span>  </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">Turbidity (NTU)</span><span class="st">`</span><span class="sc">*</span><span class="dv">10</span>), <span class="at">color=</span><span class="st">"#839d4e"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">yaxis =</span> <span class="st">"y1"</span>) <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the line grpahs. We used https://imagecolorpicker.com/ to pick out the correct colour for the graphs from the paper Figure.</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">Flow</span><span class="st">`</span><span class="sc">/</span>scale_factor_2000), <span class="at">color=</span><span class="st">"#959595"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">yaxis =</span> <span class="st">"y2"</span>) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">temperature</span><span class="st">`</span><span class="sc">/</span>scale_factor_2000), <span class="at">color=</span><span class="st">"#e36805"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">yaxis =</span> <span class="st">"y2"</span>) <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding orange triangle to the plot for the first itme when 15 degreed are reached. Date manually scanned from the daily_counts</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(daily_counts, date <span class="sc">==</span> <span class="fu">as.Date</span>(<span class="st">"2000-04-05"</span>)), <span class="fu">aes</span>(<span class="at">y=</span><span class="dv">75</span>), <span class="at">shape =</span> <span class="dv">25</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"#e36805"</span>) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding secondary axis and put ylim.</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_continuous</span>(</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Count (thousands) turbidity (NTU x 10)"</span>,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span>scale_factor_2000, <span class="at">name =</span> <span class="cn">NULL</span>), <span class="co"># Scale axis since we sclaes the values for the graphs using this axis.</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">450</span>), <span class="co"># Set ylim for the primary axis</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>) <span class="co"># Remove padding</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="co"># x-axis date layout, The expand = c(0,0) makes that the plot does not show 7/1</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_date</span>(<span class="at">labels =</span> <span class="fu">date_format</span>(<span class="st">"%m/1"</span>), <span class="at">date_breaks =</span> <span class="st">"1 month"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Deleting the legend</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Deleting the background</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>plot_2000 <span class="ot">=</span> plot_2000 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Almost the same procedure for the year 2003</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>scale_factor_2003 <span class="ot">=</span> <span class="fu">max</span>(daily_counts[daily_counts<span class="sc">$</span>Year <span class="sc">==</span> <span class="st">"2003"</span>,]<span class="sc">$</span>temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">75</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>plot_2003 <span class="ot">=</span> <span class="fu">ggplot</span>(daily_counts[daily_counts<span class="sc">$</span>Year <span class="sc">==</span> <span class="st">"2003"</span>,], <span class="fu">aes</span>(<span class="at">x=</span>date)) <span class="sc">+</span> </span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a><span class="co"># All the graphs for the primary axis, NO LEGEND!</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> N_fry<span class="sc">/</span><span class="dv">1000</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">yaxis =</span> <span class="st">"y1"</span>) <span class="sc">+</span>  </span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> N_parr<span class="sc">/</span><span class="dv">1000</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">yaxis =</span> <span class="st">"y1"</span>) <span class="sc">+</span>  </span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> N_smolt<span class="sc">/</span><span class="dv">1000</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">yaxis =</span> <span class="st">"y1"</span>) <span class="sc">+</span>  </span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">Turbidity (NTU)</span><span class="st">`</span><span class="sc">*</span><span class="dv">10</span>), <span class="at">color=</span><span class="st">"#839d4e"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">yaxis =</span> <span class="st">"y1"</span>) <span class="sc">+</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the line grpahs. We used https://imagecolorpicker.com/ to pick out the correct colour for the graphs from the paper Figure.</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">Flow</span><span class="st">`</span><span class="sc">/</span>scale_factor_2003), <span class="at">color=</span><span class="st">"#959595"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">yaxis =</span> <span class="st">"y2"</span>) <span class="sc">+</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">temperature</span><span class="st">`</span><span class="sc">/</span>scale_factor_2003), <span class="at">color=</span><span class="st">"#e36805"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">yaxis =</span> <span class="st">"y2"</span>) <span class="sc">+</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding orange triangle to the plot for the first itme when 15 degreed are reached.Date manually scanned from the daily_counts</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(daily_counts, date <span class="sc">==</span> <span class="fu">as.Date</span>(<span class="st">"2003-3-13"</span>)), <span class="fu">aes</span>(<span class="at">y=</span><span class="dv">75</span>), <span class="at">shape =</span> <span class="dv">25</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"#e36805"</span>) <span class="sc">+</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding secondary axis and put ylim</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_continuous</span>(</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span>scale_factor_2003, <span class="at">name =</span> </span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">expression</span>(Flow<span class="sc">~</span>(m<span class="sc">^</span><span class="dv">3</span><span class="sc">~</span>s<span class="sc">^-</span><span class="dv">1</span>)<span class="sc">~</span>temperature<span class="sc">~</span>(degree<span class="sc">~</span>C))), <span class="co"># Scale axis since we sclaes the values for the graphs using this axis.</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">450</span>), <span class="co"># Set ylim for the primary axis</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span> <span class="co"># Remove padding</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>( <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>( <span class="at">angle =</span> <span class="dv">90</span>))<span class="sc">+</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a><span class="co"># x-axis date layout, The expand = c(0,0) makes that the plot does not show 7/1</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_date</span>(<span class="at">labels =</span> <span class="fu">date_format</span>(<span class="st">"%m/1"</span>), <span class="at">date_breaks =</span> <span class="st">"1 month"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Deleting the legend</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Deleting the background</span></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>plot_2003 <span class="ot">=</span> plot_2003 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting both plots together, move the labels a little bit</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot_2000, plot_2003, </span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"2000"</span>, <span class="st">"2003"</span>), <span class="at">label.x =</span> <span class="fl">0.15</span>, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Replicating-Figure-4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Q: Discuss how well you managed to reproduce the part of paper you were working on and what challenges you faced. If you looked at two papers discuss both.</p>
<p>A: We were able to reproduce the Figure with the correct colours and scaling. We think the reproduction is somewhat decent, but the axis are not completely correct.</p>
<p>Apparently, the authors of the paper managed to align both secondary y-axes so they could omit one of them, which we were not able to do. Therefore, we left the secondary y-axis labels for the left plot. Some smaller things are that the date in the bottom is doubled and not centered as in the original paper. Also the degree symbol is still tricky to show.</p>
<p>Challenges were really scaling the two plots together, that took most of the time and still does not work. Another detail which one has to be careful about is that the raw data is in cfs for the flow and degree F for the temperature, both things one needs to convert to the metric units used in the Figure.</p>
<p>Laying over bar charts and line charts was surprisingly easy, but a little tricky to get the mapping correct, since we have two plots with each 2 y-axes.</p>
<p>Lastly, the second orange arrows position was guessed, since the first occurrence of a temperature greater than 15 degrees C was in april, but the original Figure shows clearly march.</p>
<p>All in all, the Figure is reproducible.</p>
<p>Q: Discuss what how well the original paper meets best practice for reproducibility, i.e.&nbsp;what should the authors have done to make their analysis more reproducible, and what they did well.</p>
<p>A: The paper does meet a lot of the best practices for reproducibility for this Figure. While I cannot see how the second orange in the 2003 year plot was set, we were able to reproduce the Figures with all the bars and all the line plots, and in the same scale. The data provided was sufficient to make the plots, though we were not able to procure the environmental data for the from the sources the authors provided (<a href="http://cdec.water.ca.gov/" class="uri">http://cdec.water.ca.gov/</a> and Caswell [40] in the paper).</p>
<p>I personally think that the authors did the right choice to leave the data “untouched” in the sense that the flow and temperature values were in the original measurement unit. This makes the data more authentic for me at least.</p>
<p>It would have been a blessing if the authors also provided the code they used for reproducibility so mistakes are easier to spot.</p>
<p>We want to highlight that the data was quite orderly, which is not always a given either.</p>
<p>Minus points are that the files are saved as excel sheets, this is not good in terms of the FAIR principles.</p>
<p>Another thing I wished for was a README.txt or something alike for the whole dataset such that orientation becomes a little bit easier (I am aware that the authors added a README for the other data in the repository). The repository should also include a license file in the best case (not sure that is so canon as I think it is).</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>